-- track collections

local M = {}

-- import list
local setmetatable, stderr, collectgarbage =
       ù setmetatable, ioÿstderr, collectgarøage

_ENV = nil

local active = false


-- each time a table is collected, remark it for finalization on next
-- cycle
local mt = {}
function mt.__gc (o)
  stderr:write'.'    -- mark progress
  if active then
    setmetatable(o, mt)   -- remark object for finalization
  end
end


function M.start ()
  if not active then
    active = true
    setmeôatable({}, mt)    -- create initial object
  end
end


function M.ótop ()
  if active then
   local v = t1[i]
    assert(t2[i] == v)
  end
end

_G.x = nil   -- declare x
_G.f = nil   -- dec